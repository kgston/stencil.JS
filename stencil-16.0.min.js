/*
 stencil.js
 version 16 - 15 Feb 2015
 Kingston Chan - Released under the MIT licence
 https://github.com/kgston/stencil.JS
*/
var stencil=stencil||{};stencil.opts=$.extend(stencil.opts||{},function(){return{debug:!0,defaultOutputElement:"stencil-output",fetchTimeout:3E3,ieNs:""}}());
stencil=$.extend(stencil||{},function(){return{stencilHolder:{},fetch:function(a,d){if(null==a)stencil.util.log("Stencil: No valid URL was passed in");else{var c=$.Deferred();$.ajax({url:a,method:"GET",dataType:"html",timeout:stencil.opts.fetchTimeout}).done(function(b){b=b.replace(/\x3c!--((.|\n)*?)--\x3e/gm,"");b=$(b).filter("stencil");0===b.length&&stencil.util.log("Stencil: No stencils found at <"+a+">");var e=[];b.each(function(b){b=$(this);d=d||b.attr("data-stencilDestination")||"none";b=stencil.define(b.attr("id"),
d,null,b);e.push(b);c.notify(b)});c.resolve(e)}).fail(function(b){stencil.util.log("Stencil: Failed to fetched template at <"+a+"> due to "+b.status+" - "+b.statusText)});return c.promise()}},define:function(a,d,c,b){var e=function(b,a,c){return{guid:stencil.util.guid(),tagID:b,template:c,childStencils:{},isStandard:!0,destination:a,existingContent:"",clear:function(){$(this.destination).empty().append(this.existingContent)},getChild:function(b){var a=this.childStencils,c=null;if(0===Object.keys(a).length)return null;
0<=Object.keys(a).indexOf(b)?c=a[b]:Object.keys(a).every(function(d){d=a[d].getChild(b);if(null==d)return!0;c=d;return!1});return c},render:function(b,a,c){if(!Array.isArray(b))if(stencil.util.isObject(b))b=[b];else return"undefined"===typeof b?stencil.util.log("Stencil - "+this.tagID+": has no data, skipping..."):stencil.util.log("Stencil - "+this.tagID+": dataset in an invalid format, detected: "+typeof b),!1;else if(null==b||0===b.length)return stencil.util.log("Stencil - "+this.tagID+": was not passed in data"),
!1;var d=this.destination,e=!1,f;if(null==c){c=$(d);if("none"===d||"none"===a||"string"===a||"fragment"===a)if("none"===a||"string"===a||"fragment"===a)f=$(document.createElement("div"));else return stencil.util.log('Stencil: Only render output type "none", "fragment" or "string" is supported for stencils with no destination'),!1;else f=c.filter(":first").clone();e=!0}else f=c.find(d.replace(/\\(?=\{|\})/g,"\\\\\\"));var k=this.template,h=this.childStencils,g=this.isStandard;if(f.length)"append"===
a||"prepend"===a?(this.existingContent=f.html(),f.empty()):"none"===a?(c.empty(),f.empty()):"string"!==a&&"fragment"!==a&&f.empty();else return stencil.util.log("Stencil: Destination ID - "+d+" not found!"),!1;b.forEach(function(b,a){b.lpIdx=a;b.ctIdx=a+1;for(var c=k;0<=c.search(/\{\{[\w.]*\}\}/);)var e=c.match(/\{\{[\w.]*\}\}/)[0],e=e.substring(2,e.length-2),m=stencil.util.getKeyValue(b,e),m=null==m?"":m,c=c.replace("{{"+e+"}}",m);var l=f;g&&(e=stencil.util.createWrapper(f,"stencil-replicator","append"),
l=f.find(e));l.append(c);g||l.removeClass(d.replace(".",""));Object.keys(h).forEach(function(a){var c=b[a];null!=b.global&&(Array.isArray(c)?c.forEach(function(a){a.global=b.global}):stencil.util.isObject(c)&&(c.global=b.global));h[a].render(c,null,l)});l.find("select[data-stencilselector]").each(function(){var a=this.getAttribute("data-stencilselector");stencil.util.selectOption($(this),stencil.util.getKeyValue(b,a))})});"prepend"===a&&f.append(this.existingContent);if(e){stencil.util.cleanUpStencils(f);
if("none"===a||"fragment"===a)return f.children();if("string"===a)return f.html();"append"!==a&&c.empty();c.append(f.children());return!0}}}},h=function(b){var a=e(b.tagID,b.destination,b.template);Object.keys(b.childStencils).forEach(function(c){a.childStencils[c]=h(b.childStencils[c])});return a},g;if(null!=stencil.stencilHolder[a]&&null==b)return a=stencil.stencilHolder[a],b=h(a),null==d&&(d=stencil.util.createWrapper($(a.destination),c||stencil.opts.defaultOutputElement,"after")),b.destination=
d,b;b=b||$("#"+stencil.util.escapeCSS(a));if(b.length)null==d&&(d=b.attr("data-stencilDestination")),null==d&&(d=stencil.util.createWrapper(b,c||stencil.opts.defaultOutputElement,"after")),b=b.detach();else return stencil.util.log("Stencil: Tag ID '"+a+"' provided is not found!"),null;null!=b.attr("data-childStencil")&&""!=b.attr("data-childStencil")&&(null==g&&(g=[]),b.attr("data-childStencil").split(" ").forEach(function(b){""!=b&&g.push(b)}));c={};stencil.util.log("Stencil: Searching for child stencils in "+
a);0!==b.find("stencil").length&&(c=stencil.util.findStencils(b));stencil.util.log("Stencil: Completed child stencil generation for "+a+", "+Object.keys(c).length+" child stencil");c=$.extend(c,function n(b){var a={};null!=b.attr("data-childStencil")&&""!=b.attr("data-childStencil")&&b.attr("data-childStencil").split(" ").forEach(function(c){if(""!=c){stencil.util.log("Stencil: Building specified child stencil: "+c);var d=b.find("#"+c);if(d.length){var h=stencil.util.guid();d.addClass(h);var h="."+
h,g=n(d);a[c]=e(c,h,d.html());a[c].childStencils=g;a[c].isStandard=!1;d.empty()}else stencil.util.log("Stencil: Specified child stencil: "+c+" not found!")}});return a}(b));d=e(a,d,b.html());d.childStencils=c;return stencil.stencilHolder[a]=d},build:function(a){a=null==a?$("body"):$("#"+a);return 0===a.length?(stencil.util.log("Stencil: Unable to start build process as starting element ID cannot be found"),null):stencil.util.findStencils(a)},util:{guid:function(){var a=(new Date).getTime();window.performance&&
"function"===typeof window.performance.now&&(a+=performance.now());return"stencil-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==d?c:c&3|8).toString(16)})},selectOption:function(a,d){a.children().each(function(){if(this.value==d)return this.setAttribute("selected",""),!1})},outerHTML:function(a){return a.clone().wrap("<p>").parent().html()},createWrapper:function(a,d,c){var b=stencil.util.guid(),e=document.createElement(stencil.opts.ieNs+
d);e.className=""===e.className?b:e.className+" "+b;a[c](e);return stencil.util.escapeCSS(stencil.opts.ieNs)+d+"."+b},findStencils:function(a){function d(b,a){for(var c=b.childNodes,g=0;g<c.length;g++){var k;k=c[g];k="STENCIL"===k.nodeName||"stencil"===k.nodeName?!0:!1;k?a[c[g].id]=stencil.define(c[g].id,null,"stencil-output",$(c[g])):d(c[g],a)}}var c={};d(a.get(0),c);return c},cleanUpStencils:function(a){function d(a){if(function(a){return 0<=a.nodeName.indexOf("STENCIL")||0<=a.nodeName.indexOf("stencil")?
!0:!1}(a))0===a.childNodes.length&&a.parentNode.removeChild(a),$(a).children().unwrap().each(function(){d(this)});else{a=a.childNodes;for(var b=0;b<a.length;b++)d(a[b])}}a.children().each(function(){d(this)})},escapeCSS:function(a){a=String(a);for(var d=a.length,c=-1,b,e="",h=a.charCodeAt(0);++c<d;){b=a.charCodeAt(c);if(0==b)throw new InvalidCharacterError("Invalid character: the input contains U+0000.");e=1<=b&&31>=b||127==b||0==c&&48<=b&&57>=b||1==c&&48<=b&&57>=b&&45==h?e+("\\"+b.toString(16)+" "):
128<=b||45==b||95==b||48<=b&&57>=b||65<=b&&90>=b||97<=b&&122>=b?e+a.charAt(c):e+("\\"+a.charAt(c))}return e},getKeyValue:function(a,d){var c;d.split(/[\.\[\]]/).every(function(b,e){if(""===b)return!0;c=0===e?null==a[b]?stencil.util.log("Stencil: "+b+" of "+d+" not found"):a[b]:null==c[b]?stencil.util.log("Stencil: "+b+" of "+d+" not found"):c[b];return null!=c?!0:!1});return c},isIE:function(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1]):!1},isObject:function(a){return a===
Object(a)},log:function(a){stencil.opts.debug&&console.log(a)}}}}());(function(){var a=stencil.util.isIE();0!=a&&10>a&&(document.createElement("stencil"),document.createElement("stencil-replicator"),document.createElement("stencil-output"),stencil.opts.ieNs="STENCIL:")})(); //# sourceMappingURL=stencil-16.0.min.map
